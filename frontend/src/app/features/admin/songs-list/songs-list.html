<div class="flex flex-col gap-6 animate-in fade-in slide-in-from-bottom-4 duration-500">

  <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
    <div>
      <h1 class="text-3xl font-bold text-white tracking-tight">Songs Library</h1>
      <p class="text-zinc-400 mt-1">Manage your music catalog efficiently.</p>
    </div>

    <a routerLink="/admin/upload" class="px-5 py-2.5 bg-accent text-black font-bold rounded-lg hover:bg-accent/90 transition flex items-center justify-center gap-2 shadow-lg shadow-accent/20">
      <i class="ri-upload-cloud-2-line"></i>
      <span>Upload Track</span>
    </a>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
    <div class="bg-zinc-900/50 border border-white/5 p-4 rounded-xl flex items-center gap-4">
      <div class="w-12 h-12 rounded-full bg-blue-500/10 text-blue-500 flex items-center justify-center text-xl">
        <i class="ri-music-2-fill"></i>
      </div>
      <div>
        <p class="text-xs text-zinc-500 uppercase font-bold">Total Tracks</p>
        <p class="text-xl font-bold text-white">{{ songStore.songs().length }}</p>
      </div>
    </div>
  </div>

  @if (songStore.isLoading()) {
    <div class="py-20 flex flex-col items-center justify-center text-zinc-500 gap-3">
      <i class="ri-loader-4-line text-4xl animate-spin text-accent"></i>
      <p class="text-sm">Loading library...</p>
    </div>
  }

  @if (songStore.error()) {
    <div class="p-4 bg-red-500/10 border border-red-500/20 text-red-400 rounded-lg text-center">
      {{ songStore.error() }}
    </div>
  }

  @if (!songStore.isLoading() && !songStore.error()) {
    <div class="bg-zinc-900/30 border border-white/5 rounded-xl overflow-hidden backdrop-blur-sm">
      <div class="overflow-x-auto">
        <table class="w-full text-left border-collapse">

          <thead class="bg-white/5 text-xs font-bold text-zinc-500 uppercase tracking-wider">
          <tr>
            <th class="px-6 py-4">Track Details</th>
            <th class="px-6 py-4">Artist</th>
            <th class="px-6 py-4">Uploaded At</th>
            <th class="px-6 py-4 text-right">Actions</th>
          </tr>
          </thead>

          <tbody class="divide-y divide-white/5">

            @for (song of songStore.songs(); track song.id) {
              <tr class="group hover:bg-white/5 transition duration-200">

                <td class="px-6 py-4">
                  <div class="flex items-center gap-4">
                    <div class="relative w-12 h-12 rounded-lg overflow-hidden bg-zinc-800 shadow-lg group-hover:scale-105 transition shrink-0">
                      <img [src]="song.coverUrl | imgUrl" alt="Cover" class="w-full h-full object-cover">
                      <div class="absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition">
                        <i class="ri-play-mini-fill text-white"></i>
                      </div>
                    </div>
                    <div class="min-w-0">
                      <p class="font-bold text-white text-sm truncate max-w-[200px]">{{ song.title }}</p>
                      <span class="text-[10px] text-zinc-500 bg-white/5 px-1.5 py-0.5 rounded border border-white/5">MP3</span>
                    </div>
                  </div>
                </td>

                <td class="px-6 py-4">
                  <span class="text-sm text-zinc-300 font-medium">{{ song.artist }}</span>
                </td>

                <td class="px-6 py-4">
                  <span class="text-sm text-zinc-500 font-mono">
                    {{ song.createdAt | date:'mediumDate' }}
                  </span>
                </td>

                <td class="px-6 py-4 text-right">
                  <div class="flex items-center justify-end gap-2 opacity-0 group-hover:opacity-100 transition-opacity">

                    <button class="w-8 h-8 rounded-lg bg-zinc-800 text-zinc-400 hover:text-white hover:bg-zinc-700 flex items-center justify-center transition border border-white/5 cursor-pointer" title="Edit">
                      <i class="ri-pencil-line"></i>
                    </button>

                    <button (click)="onDelete(song.id)" class="w-8 h-8 rounded-lg bg-red-500/10 text-red-500 hover:bg-red-500 hover:text-white flex items-center justify-center transition border border-red-500/20 cursor-pointer" title="Delete">
                      <i class="ri-delete-bin-line"></i>
                    </button>

                  </div>
                </td>
              </tr>
            } @empty {
              <tr>
                <td colspan="4" class="px-6 py-16 text-center text-zinc-500">
                  <div class="flex flex-col items-center gap-3">
                    <div class="w-16 h-16 rounded-full bg-zinc-800/50 flex items-center justify-center">
                      <i class="ri-music-2-line text-3xl opacity-30"></i>
                    </div>
                    <p class="font-medium">No songs found in the library.</p>
                    <a routerLink="/admin/upload" class="text-accent text-sm hover:underline font-bold cursor-pointer">
                      Upload your first track
                    </a>
                  </div>
                </td>
              </tr>
            }

          </tbody>
        </table>
      </div>
    </div>
  }

</div>
